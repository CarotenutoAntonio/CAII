clc;
clear;
close all;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% NUMERICO %% ALLUMINIO %% RAGGIO GRANDE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
y_v2=[0.00725805
0.0216553
0.0358147
0.04973625
0.06342
0.0768659
0.09007395
0.10304425
0.1157765
0.128271
0.140528
0.152547
0.164328
0.175871
0.1871765
0.198244
0.2090735
0.2196655
0.2300195
0.2401355
0.250014
0.2596545
0.269057
0.278222
0.287149
0.295838
0.3042895
0.312503
0.3204785
0.3282165
0.3357165
0.342979
0.3500035
0.35679
0.3633385
0.369649
0.375722
0.3815575
0.387155
0.3925145
0.397636
0.4025195
0.4071655
0.4115735
0.415744
0.4196765
0.423371
0.426828
0.430047
0.433028
0.4357715
0.438277
0.4405445
0.4425745
0.4443665
0.4459205
0.447237
0.4483155
0.449156
0.44975
];


sigma_xal = flipud([
    844.27
832.664795
806.3466797
773.8984681
737.0577088
697.6300964
657.2841797
617.4602051
579.2918701
543.5854187
510.8451233
481.3190461
455.0527192
431.9436951
411.7914887
394.33815
379.2988281
366.3856964
355.3230133
345.8554382
337.7532349
330.813736
324.8605805
319.7420044
315.3283691
311.5097504
308.1932984
305.3007813
302.7663727
300.5346833
298.5590363
296.8001709
295.2250519
293.8056488
292.5181885
291.3425293
290.2613984
289.2599946
288.3255768
287.447052
286.6147766
285.820221
285.0557709
284.3145447
283.5901947
282.8767853
282.1686401
281.4601135
280.7454682
280.0186921
279.2732697
278.5019531
277.6963959
276.8467712
275.9412842
274.9654083
273.9008789
272.7243347
271.4052429
269.9026184
])/269.903;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% NUMERICO %% ALLUMINIO %% RAGGIO PICCOLO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
y_v=[0
0.0164835
0.0326879
0.0486132
0.0642595
0.0796266
0.0947146
0.109523
0.124053
0.138304
0.152276
0.165968
0.179381
0.192516
0.205371
0.217947
0.230244
0.242262
0.254001
0.26546
0.276641
0.287542
0.298165
0.308508
0.318572
0.328357
0.337863
0.34709
0.356038
0.364707
0.373096
0.381207
0.389038
0.39659
0.403863
0.410857
0.417572
0.424008
0.430165
0.436042
0.441641
0.44696
0.452001
0.456762
0.461244
0.465447
0.469371
0.473016
0.476382
0.479468
0.482276
0.484804
0.487053
0.489024
0.490715
0.492127
0.49326
0.494113
0.494688
0.494984
0.495
];

sigma_x=[277.69
    277.6979
    277.7135315
277.727005
277.7388306
277.7493592
277.7588806
277.7676239
277.7757416
277.783371
277.7906189
277.7975769
277.8043213
277.8109131
277.8174286
277.8239289
277.8304749
277.8371277
277.8439789
277.8511047
277.8585663
277.8665009
277.8750306
277.8842926
277.8945007
277.9058228
277.9185028
277.9329071
277.9494019
277.9684601
277.9906769
278.0168152
278.0478058
278.0848236
278.1294556
278.1837463
278.2502289
278.3323517
278.4346771
278.5633393
278.7267151
278.9362793
279.2080994
279.5651551
280.04068
280.6836548
281.5686493
282.8117524
284.5996094
287.242096
291.2700196
297.6187592
307.9611054
325.2754059
354.6507111
403.8528138
481.7198334
590.3681031
710.551117
796.223053
824.72311
]/277.6892853;
K_t_num = sigma_x(end);


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% TEORICO %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
sigma_0 = 1;
R = 0.005;
R2 = 0.05;
K_t = 3;
err = (K_t-K_t_num)*100/K_t;
N = 60;
y = linspace(0, 0.05,N);
sigma_x_t = (sigma_0 / 2) * (2 + (R./ y).^2 + 3 * (R./ y).^4 - (K_t - 3) * (5 * (R./ y).^6 - 7 * (R./ y).^8));


disp('piastra alluminio ');
disp(['Il K_t teroico è:  ',num2str(K_t)]);
disp (['il k_t numerico è:',num2str(K_t_num) ]);
disp (['l''errore è: ', num2str(err),'%']);
%% PLOT
y_v=0.5-y_v;
figure(1)
plot(y_v/R,sigma_x,'LineStyle','-','Color',"b","LineWidth",1);
hold on;
grid on

y_v2=0.5-y_v2;
plot(y_v2/R2,sigma_xal,'LineStyle','-','Color',"r","LineWidth",1);


plot(y/R,sigma_x_t,'LineStyle','--','Color',"k","LineWidth",1.2);
title('Piastra in alluminio');
axis([0 9.5 0 3])
xlabel('y/R','Interpreter','latex','FontSize',12);
ylabel('$\sigma_x$/$\sigma_0$','Interpreter','latex','FontSize',12')
lgd = legend('$numerico_{R=0.005m}$','$numerico_{R=0.05m}$','$teorico$');
lgd.Interpreter = 'latex'; 
lgd.FontSize = 11;





%% COMPOSITO [0]24
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% sequenza di laminazione 
seq_theta1 = [0 0 0 0 0 0 0 0 0 0 0 0];
%seq_theta2 = [0 90 0 90 0 90 0 90];

ABBD_eval = ABBD(seq_theta1);
A = ABBD_eval(1:3,1:3);
%% NUMERICO %% GRANDE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
sigma_x002 = flipud([
1626.252381
1458.93274
1250.911011
1069.000946
920.8101197
803.2496338
710.4819947
637.0003968
578.3728638
531.2080231
492.9510193
461.6725769
435.9066773
414.5303956
396.6767884
381.6693726
368.9687042
358.1510162
348.8785095
340.873291
333.9173279
327.8349304
322.4798889
317.7339478
313.5023041
309.7072754
306.2863465
303.1898652
300.3753663
297.8095856
295.466156
293.3244324
291.3674011
289.5797424
287.9504547
286.469986
285.1290894
283.9198151
282.8342743
281.8648834
281.0034943
280.2411041
279.5696259
278.979477
278.4601899
278.0027466
277.5965729
277.2301636
276.8924561
276.5710449
276.2523041
275.9207459
275.5583344
275.1436768
274.6487274
274.0357056
273.2512512
272.2148285
270.7910919
268.7669525
])/268.77;



%% NUMERICO %% PICCOLO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

sigma_x00=flipud([ 1521.136792
1308.566712
918.6875611
599.0252838
450.293808
376.9494934
338.0812378
316.1302033
303.11763
295.0766907
289.9314423
286.5355835
284.2299195
282.6266938
281.4891663
280.6657257
280.0581055
279.6033173
279.2595978
278.9960022
278.7890473
278.6248169
278.4952393
278.3899536
278.302887
278.2312317
278.1704865
278.1188355
278.0746003
278.0359345
278.0015259
277.9710388
277.9441071
277.9194031
277.8974762
277.8782044
277.8604584
277.8444977
277.8305207
277.8179932
277.8071442
277.7981415
277.789917
277.7827301
277.7770844
277.7723694
277.7684937
277.7651368
277.7619934
277.759491
277.7502594
277.7411804
277.7459869
277.749649
277.7447968
277.7372132
277.7203522
277.7069397
277.7125397
277.7125244
277.7125244
])/277.7125244;


K_t_num = sigma_x00(end);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% TEORICO %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
A11 = A(1,1);
A12 = A(1,2);
A22 = A(2,2);
A66 = A(3,3);
K_t =  1 + sqrt((2 / A22) * (sqrt(A11 * A22) - A12 + ((A11 * A22 - A12^2) / (2 * A66))));
N = 60;
y = linspace(0.005, 0.05,N);
sigma_x_t = (sigma_0 / 2) * (2 + (R./ y).^2 + 3 * (R./ y).^4 - (K_t - 3) * (5 * (R./ y).^6 - 7 * (R./ y).^8));
err0 = (K_t-K_t_num)*100/K_t;
disp('sequenza [0]24 ');
disp(['Il K_t teroico è:  ',num2str(K_t)]);
disp (['il k_t numerico è: ',num2str(K_t_num) ]);
disp (['l''errore è: ', num2str(err0),'%']);

%% PLOT
figure(2)
plot(y_v/R,sigma_x00,'LineStyle','-','Color',"b","LineWidth",1);
hold on;
grid on

plot(y_v2/R2,sigma_x002,'LineStyle','-','Color',"r","LineWidth",1);


plot(y/R,sigma_x_t,'LineStyle','--','Color',"k","LineWidth",1.2);
title('Sequenza [0]24');
axis([0 9.5 0 6])
xlabel('y/R','Interpreter','latex','FontSize',12);
ylabel('$\sigma_x$/$\sigma_0$','Interpreter','latex','FontSize',12')
lgd = legend('$numerico_{R=0.005m}$','$numerico_{R=0.05m}$','$teorico$');
lgd.Interpreter = 'latex'; 
lgd.FontSize = 11;


%% COMPOSITO [90]24
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% sequenza di laminazione 
seq_theta2 = [90 90 90 90 90 90 90 90 90 90 90 90];
%seq_theta2 = [0 90 0 90 0 90 0 90];

ABBD_eval = ABBD(seq_theta2);
A = ABBD_eval(1:3,1:3);

%% NUMERICO %% PICCOLO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
sigma_x902=flipud([
717.37
703.0818335
685.4323731
663.7874146
639.2470093
612.9835206
586.0448304
559.2625733
533.2822571
508.5727997
485.4396057
464.0524292
444.4750824
426.6960449
410.6525726
396.2471771
383.3624268
371.8727875
361.6530609
352.5817261
344.5413208
337.420929
331.1186371
325.5423432
320.6092835
316.2457733
312.3866577
308.9738465
305.955597
303.2856903
300.9226837
298.829422
296.9728546
295.3238068
293.8562775
292.547226
291.3764039
290.3259888
289.3803253
288.5255737
287.7495117
287.0413208
286.3913117
285.7907715
285.2315979
284.7061157
284.2069702
283.7267609
283.2576294
282.7908783
282.3164063
281.8219147
281.2917175
280.7049561
280.0328522
279.2341614
278.2472687
276.9755554
275.2573853
272.7851105
])/271.309;
%% NUMERICO %% PICCOLO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

sigma_x90 = [
    
277.7070313
277.7399597
277.7612305
277.7759094
277.7859497
277.7936707
277.7999268
277.8053589
277.8107605
277.8149414
277.8179932
277.8214722
277.8250427
277.8287354
277.8326721
277.836792
277.841217
277.8460083
277.8512268
277.8569946
277.8634338
277.8706055
277.8786926
277.8878784
277.8983459
277.9103699
277.9242554
277.9403687
277.9592285
277.9813843
278.0075684
278.0387878
278.0761414
278.1212463
278.1759338
278.2430115
278.3256531
278.4285583
278.5579224
278.7221069
278.9328613
279.2073669
279.5694885
280.0547485
280.7166748
281.6381226
282.9480591
284.8525085
287.6816101
291.9381409
298.3819885
308.1690979
323.0491638
345.6376343
379.6477661
429.6502075
499.0505066
583.9540405
663.2302856
699.680542
701.98
]/277.7070313;


K_t_num = sigma_x90(end);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% TEORICO %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
A11 = A(1,1);
A12 = A(1,2);
A22 = A(2,2);
A66 = A(3,3);
K_t =  1 + sqrt((2 / A22) * (sqrt(A11 * A22) - A12 + ((A11 * A22 - A12^2) / (2 * A66))));
N = 60;
y = linspace(0.005, 0.05,N);
sigma_x_t = (sigma_0 / 2) * (2 + (R./ y).^2 + 3 * (R./ y).^4 - (K_t - 3) * (5 * (R./ y).^6 - 7 * (R./ y).^8));
err0 = (K_t-K_t_num)*100/K_t;
disp('sequenza [90]24 ');
disp(['Il K_t teroico è:  ',num2str(K_t)]);
disp (['il k_t numerico è: ',num2str(K_t_num) ]);
disp (['l''errore è: ', num2str(err0),'%']);
%% PLOT
figure(3)
plot(y_v/R,sigma_x90,'LineStyle','-','Color',"b","LineWidth",1);
hold on;
grid on

plot(y_v2/R2,sigma_x902,'LineStyle','-','Color',"r","LineWidth",1);

plot(y/R,sigma_x_t,'LineStyle','--','Color',"k","LineWidth",1.2);
title('Sequenza [90]24');
axis([0 9.5 0 6])
xlabel('y/R','Interpreter','latex','FontSize',12);
ylabel('$\sigma_x$/$\sigma_0$','Interpreter','latex','FontSize',12')
lgd = legend('$numerico_{R=0.005m}$','$numerico_{R=0.05m}$','$teorico$');
lgd.Interpreter = 'latex'; 
lgd.FontSize = 11;




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% COMPOSITO [0/90]12s
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% sequenza di laminazione 
seq_theta2 = [0 90 0 90 0 90 0 90 0 90 0 90];
%seq_theta2 = [0 90 0 90 0 90 0 90];

ABBD_eval = ABBD(seq_theta2);
A = ABBD_eval(1:3,1:3);


%% NUMERICO %% GRANDE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

sigma_x0902=flipud([
    1213.85
1133.149768
1022.456451
913.7404785
815.9477234
731.9820557
661.4990235
602.8802796
554.2331543
513.7986908
480.0777588
451.8370362
428.0794373
408.0032349
390.9646302
376.4444428
364.0178833
353.3417206
344.1352997
336.1639405
329.2371064
323.1971283
317.9104614
313.2655182
309.1694184
305.5439453
302.3233185
299.4522858
296.8829956
294.5754089
292.4957275
290.6159668
288.9123383
287.3636628
285.9530793
284.6665345
283.4915772
282.4178314
281.4364929
280.5401459
279.7220154
278.9757233
278.2962799
277.6783142
277.1162415
276.605774
276.1417389
275.7182922
275.3298492
274.9698944
274.6307831
274.3031464
273.9751892
273.6313782
273.248581
272.7905884
272.1964722
271.3525391
270.0210114
267.602829
])/267.6;


%% NUMERICO %% PICCOLO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

sigma_x090 = [277.7017822
    277.7017822
    277.7017822
   277.7159119
277.7308502
277.7323456
277.7457581
277.7600708
277.76297
277.7662354
277.7740631
277.7825775
277.7878723
277.7931824
277.7984314
277.8038941
277.8098755
277.816391
277.823822
277.8318176
277.8401337
277.8495331
277.8599701
277.8713074
277.8840027
277.8979798
277.9131012
277.9303589
277.9500275
277.9719391
277.9972687
278.0265198
278.0602722
278.0998383
278.1472626
278.2044373
278.2733612
278.358429
278.4631653
278.5941468
278.7614899
278.9745331
279.2488556
279.6099701
280.092392
280.7441254
281.638855
282.8927307
284.6884308
287.3145905
291.2363587
297.2162628
306.5171509
321.290802
345.3966675
386.1102448
457.814209
589.7662506
823.311554
1072.539734
1193.6
]/277.7017822;


K_t_num = sigma_x090(end);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% TEORICO %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
A11 = A(1,1);
A12 = A(1,2);
A22 = A(2,2);
A66 = A(3,3);
K_t =  1 + sqrt((2 / A22) * (sqrt(A11 * A22) - A12 + ((A11 * A22 - A12^2) / (2 * A66))));
N = 60;
y = linspace(0.005, 0.05,N);
sigma_x_t = (sigma_0 / 2) * (2 + (R./ y).^2 + 3 * (R./ y).^4 - (K_t - 3) * (5 * (R./ y).^6 - 7 * (R./ y).^8));
err0 = (K_t-K_t_num)*100/K_t;
disp('sequenza [0,90]12s ');
disp(['Il K_t teroico è:  ',num2str(K_t)]);
disp (['il k_t numerico è: ',num2str(K_t_num) ]);
disp (['l''errore è: ', num2str(err0),'%']);
%% PLOT
figure(4)
plot(y_v/R,sigma_x090,'LineStyle','-','Color',"b","LineWidth",1);
hold on;
grid on

plot(y_v2/R2,sigma_x0902,'LineStyle','-','Color',"r","LineWidth",1);


plot(y/R,sigma_x_t,'LineStyle','--','Color',"k","LineWidth",1.2);
title('Sequenza [0/90]6s');
axis([0 9.5 0 6])
xlabel('y/R','Interpreter','latex','FontSize',12);
ylabel('$\sigma_x$/$\sigma_0$','Interpreter','latex','FontSize',12')
lgd = legend('$numerico_{R=0.005m}$','$numerico_{R=0.05m}$','$teorico$');
lgd.Interpreter = 'latex'; 
lgd.FontSize = 11;



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% COMPOSITO [45/-45]12s
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% sequenza di laminazione 
seq_theta2 = [-45 45 -45 45 -45 45 -45 45 -45 45 -45 45];
%seq_theta2 = [0 90 0 90 0 90 0 90];

ABBD_eval = ABBD(seq_theta2);
A = ABBD_eval(1:3,1:3);


%% NUMERICO %% GRANDE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

sigma_x452=flipud([
    621.14
    621.7180176
622.9321595
623.9247437
624.0681763
622.5009156
618.0279236
609.4386902
595.598938
575.9401551
551.0480347
522.6690216
493.083252
464.3760682
438.004776
414.7211761
394.7182007
377.8318939
363.7192688
351.9799347
342.2206116
334.0890808
327.2863922
321.5662689
316.7273712
312.6047821
309.0670014
306.0090332
303.3452454
301.006958
298.9389496
297.0942536
295.4345246
293.9301758
292.556015
291.2895966
290.112854
289.0113373
287.9722138
286.9845276
286.039383
285.1295624
284.2483063
283.390564
282.5523377
281.7291565
280.9182282
280.1179505
279.3265229
278.5424347
277.7648163
276.9936982
276.2290345
275.4702454
274.7175446
273.971283
273.231369
272.4978791
271.7715912
271.042923

])/271;


%% NUMERICO %% PICCOLO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

sigma_x45 = flipud( [599.66
600.5422364
597.7192688
572.2899475
510.520813
430.8855439
365.9776154
327.7164459
308.0078736
297.3131409
290.9843293
287.0411225
284.4696045
282.729477
281.5161591
280.6498414
280.0211182
279.5572052
279.2048798
278.9343109
278.7271729
278.5673829
278.4405671
278.3385621
278.2571717
278.1909943
278.1375885
278.0927277
278.0546875
278.0233002
277.9967804
277.9744568
277.9548798
277.9377442
277.9224243
277.9083557
277.8962708
277.8852387
277.8747101
277.8650818
277.8554535
277.8459473
277.8374482
277.8292389
277.8209381
277.8126831
277.8043061
277.7966156
277.7902374
277.7857514
277.7874298
277.7868042
277.7717285
277.7553559
277.7467194
277.7405243
277.7339631
277.7214814
277.7061768
277.6966095
277.6966095
])/277.697;


K_t_num = sigma_x45(end);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% TEORICO %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
A11 = A(1,1);
A12 = A(1,2);
A22 = A(2,2);
A66 = A(3,3);
K_t =  1 + sqrt((2 / A22) * (sqrt(A11 * A22) - A12 + ((A11 * A22 - A12^2) / (2 * A66))));
N = 60;
y = linspace(0.005, 0.05,N);
sigma_x_t = (sigma_0 / 2) * (2 + (R./ y).^2 + 3 * (R./ y).^4 - (K_t - 3) * (5 * (R./ y).^6 - 7 * (R./ y).^8));
err0 = (K_t-K_t_num)*100/K_t;
disp('sequenza [45,-45]12s ');
disp(['Il K_t teroico è:  ',num2str(K_t)]);
disp (['il k_t numerico è: ',num2str(K_t_num) ]);
disp (['l''errore è: ', num2str(err0),'%']);
%% PLOT
figure(5)
plot(y_v/R,sigma_x45,'LineStyle','-','Color',"b","LineWidth",1);
hold on;
grid on

plot(y_v2/R2,sigma_x452,'LineStyle','-','Color',"r","LineWidth",1);


plot(y/R,sigma_x_t,'LineStyle','--','Color',"k","LineWidth",1.2);
title('Sequenza [45/-45]6s');
axis([0 9.5 0 6])
xlabel('y/R','Interpreter','latex','FontSize',12);
ylabel('$\sigma_x$/$\sigma_0$','Interpreter','latex','FontSize',12')
lgd = legend('$numerico_{R=0.005m}$','$numerico_{R=0.05m}$','$teorico$');
lgd.Interpreter = 'latex'; 
lgd.FontSize = 11;


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% COMPOSITO [0/45/-45/90]3s
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% sequenza di laminazione 
seq_theta2 = [0 45 -45 90 0 45 -45 90 0 45 -45 90];
%seq_theta2 = [0 90 0 90 0 90 0 90];

ABBD_eval = ABBD(seq_theta2);
A = ABBD_eval(1:3,1:3);


%% NUMERICO %% GRANDE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

sigma_x045902=flipud([
    854.85
    832.6626587
806.343689
773.8947144
737.0534974
697.6257325
657.2801514
617.4566651
579.2888184
543.5828553
510.8430176
481.3173676
455.0513916
431.9426117
411.7906037
394.3374329
379.2982178
366.3851776
355.3225861
345.8550873
337.752945
330.8134918
324.8604126
319.7418976
315.3282929
311.5097046
308.1932984
305.3008118
302.7664185
300.5347443
298.5591126
296.8002625
295.2251434
293.8057404
292.5182953
291.3426514
290.2615204
289.2601166
288.3256989
287.4471894
286.6149292
285.8203736
285.0559235
284.3146973
283.5903321
282.8769226
282.1687775
281.4602356
280.745575
280.0187836
279.273346
278.5019989
277.6963959
276.8467255
275.9411927
274.965271
273.9007263
272.7242432
271.4053803
269.9033051
])/269.9;


%% NUMERICO %% PICCOLO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

sigma_x04590 = flipud( [826.84
    796.16
710.5390015
590.3609314
481.7076111
403.8383026
354.6377716
325.2668763
307.9570008
297.61763
291.270401
287.2430573
284.6006928
282.8127747
281.5695496
280.6844178
280.0413208
279.5657044
279.2085724
278.9366913
278.7270966
278.5636902
278.4349823
278.3326264
278.2504883
278.1839905
278.1296845
278.0850373
278.0480042
278.0169983
277.99086
277.9686279
277.9495545
277.9330597
277.9186402
277.9059296
277.8946076
277.8843994
277.8751221
277.8665772
277.8586121
277.8511353
277.8440094
277.837143
277.8304749
277.8239136
277.8173981
277.8108826
277.8042755
277.7975159
277.7905579
277.7832947
277.77565
277.7675324
277.7587891
277.7492523
277.7387085
277.726883
277.7134095
277.6977234
277.6977234
])/277.6977;


K_t_num = sigma_x04590(end);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% TEORICO %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
A11 = A(1,1);
A12 = A(1,2);
A22 = A(2,2);
A66 = A(3,3);
K_t =  1 + sqrt((2 / A22) * (sqrt(A11 * A22) - A12 + ((A11 * A22 - A12^2) / (2 * A66))));
N = 60;
y = linspace(0.005, 0.05,N);
sigma_x_t = (sigma_0 / 2) * (2 + (R./ y).^2 + 3 * (R./ y).^4 - (K_t - 3) * (5 * (R./ y).^6 - 7 * (R./ y).^8));
err0 = (K_t-K_t_num)*100/K_t;
disp('sequenza [45,-45]6s ');
disp(['Il K_t teroico è:  ',num2str(K_t)]);
disp (['il k_t numerico è: ',num2str(K_t_num) ]);
disp (['l''errore è: ', num2str(err0),'%']);
%% PLOT
figure(6)
plot(y_v/R,sigma_x04590,'LineStyle','-','Color',"b","LineWidth",1);
hold on;
grid on

plot(y_v2/R2,sigma_x045902,'LineStyle','-','Color',"r","LineWidth",1);


plot(y/R,sigma_x_t,'LineStyle','--','Color',"k","LineWidth",1.2);
title('Sequenza [0/45/-45/90]3s');
axis([0 9.5 0 6])
xlabel('y/R','Interpreter','latex','FontSize',12);
ylabel('$\sigma_x$/$\sigma_0$','Interpreter','latex','FontSize',12')
lgd = legend('$numerico_{R=0.005m}$','$numerico_{R=0.05m}$','$teorico$');
lgd.Interpreter = 'latex'; 
lgd.FontSize = 11;



%% CONFRONTO KT
figure(7)
subplot(2,3,1)
plot(y_v/R,sigma_x,'LineStyle','-','Color',"k","LineWidth",1);
hold on;
grid on
title('Alluminio')
axis([0 9.5 0 6])
ylabel('$\sigma_x$/$\sigma_0$','Interpreter','latex','FontSize',12')
lgd.Interpreter = 'latex'; 
lgd.FontSize = 11;

subplot(2,3,2)
plot(y_v/R,sigma_x00,'LineStyle','-','Color',"k","LineWidth",1);
hold on;
grid on
title('Sequenza [0]24')
axis([0 9.5 0 6])
lgd.Interpreter = 'latex'; 
lgd.FontSize = 11;

subplot(2,3,3)
plot(y_v/R,sigma_x90,'LineStyle','-','Color',"k","LineWidth",1);
hold on;
grid on
title('Sequenza [90]s')
axis([0 9.5 0 6])
lgd.Interpreter = 'latex'; 
lgd.FontSize = 11;

subplot(2,3,4)
plot(y_v/R,sigma_x090,'LineStyle','-','Color',"k","LineWidth",1);
hold on;
grid on
title('Sequenza [0/90]6s')
axis([0 9.5 0 6])
xlabel('y/R','Interpreter','latex','FontSize',12);
ylabel('$\sigma_x$/$\sigma_0$','Interpreter','latex','FontSize',12')
lgd.Interpreter = 'latex'; 
lgd.FontSize = 11;

subplot(2,3,5)
plot(y_v/R,sigma_x45,'LineStyle','-','Color',"k","LineWidth",1);
hold on;
grid on
title('Sequenza [45/-45]6s')
axis([0 9.5 0 6])
xlabel('y/R','Interpreter','latex','FontSize',12);
lgd.Interpreter = 'latex'; 
lgd.FontSize = 11;


subplot(2,3,6)
plot(y_v/R,sigma_x04590,'LineStyle','-','Color',"k","LineWidth",1);
hold on;
grid on
title('Sequenza [0/45/-45/90]3s')
axis([0 9.5 0 6])
xlabel('y/R','Interpreter','latex','FontSize',12);
lgd.Interpreter = 'latex'; 
lgd.FontSize = 11;
